#!/usr/bin/env /usr/local/bin/node
/* jshint esversion: 8 */
/* jshint asi: true */

// <xbar.title>Slack Team Notifications</xbar.title>
// <xbar.version>v1.1.2</xbar.version>
// <xbar.author>Benji Encalada Mora</xbar.author>
// <xbar.author.github>benjifs</xbar.author.github>
// <xbar.image>/9j/4g1cSUNDX1BST0ZJTEUAAQEAAA1MYXBwbAIQAABtbnRyUkdCIFhZWiAH5AAMABIAAAASAB1hY3NwQVBQTAAAAABBUFBMAAAAAAAAAAAAAAAAAAAAAAAA9tYAAQAAAADTLWFwcGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABJkZXNjAAABXAAAAGJkc2NtAAABwAAAAe5jcHJ0AAADsAAAACN3dHB0AAAD1AAAABRyWFlaAAAD6AAAABRnWFlaAAAD/AAAABRiWFlaAAAEEAAAABRyVFJDAAAEJAAACAxhYXJnAAAMMAAAACB2Y2d0AAAMUAAAADBuZGluAAAMgAAAAD5jaGFkAAAMwAAAACxtbW9kAAAM7AAAACh2Y2dwAAANFAAAADhiVFJDAAAEJAAACAxnVFJDAAAEJAAACAxhYWJnAAAMMAAAACBhYWdnAAAMMAAAACBkZXNjAAAAAAAAAAhEaXNwbGF5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbWx1YwAAAAAAAAAmAAAADGhySFIAAAAWAAAB2GtvS1IAAAAWAAAB2G5iTk8AAAAWAAAB2GlkAAAAAAAWAAAB2Gh1SFUAAAAWAAAB2GNzQ1oAAAAWAAAB2GRhREsAAAAWAAAB2G5sTkwAAAAWAAAB2GZpRkkAAAAWAAAB2Gl0SVQAAAAWAAAB2GVzRVMAAAAWAAAB2HJvUk8AAAAWAAAB2GZyQ0EAAAAWAAAB2GFyAAAAAAAWAAAB2HVrVUEAAAAWAAAB2GhlSUwAAAAWAAAB2HpoVFcAAAAWAAAB2HZpVk4AAAAWAAAB2HNrU0sAAAAWAAAB2HpoQ04AAAAWAAAB2HJ1UlUAAAAWAAAB2GVuR0IAAAAWAAAB2GZyRlIAAAAWAAAB2G1zAAAAAAAWAAAB2GhpSU4AAAAWAAAB2HRoVEgAAAAWAAAB2GNhRVMAAAAWAAAB2GVuQVUAAAAWAAAB2GVzWEwAAAAWAAAB2GRlREUAAAAWAAAB2GVuVVMAAAAWAAAB2HB0QlIAAAAWAAAB2HBsUEwAAAAWAAAB2GVsR1IAAAAWAAAB2HN2U0UAAAAWAAAB2HRyVFIAAAAWAAAB2HB0UFQAAAAWAAAB2GphSlAAAAAWAAAB2ABMAEcAIABIAEQAUgAgAFcAUQBIAEQAAHRleHQAAAAAQ29weXJpZ2h0IEFwcGxlIEluYy4sIDIwMjAAAFhZWiAAAAAAAADzUgABAAAAARa+WFlaIAAAAAAAAG+kAAA49gAAA5FYWVogAAAAAAAAYpQAALeGAAAY2lhZWiAAAAAAAAAkngAAD4QAALbCY3VydgAAAAAAAAQAAAAABQAKAA8AFAAZAB4AIwAoAC0AMgA2ADsAQABFAEoATwBUAFkAXgBjAGgAbQByAHcAfACBAIYAiwCQAJUAmgCfAKMAqACtALIAtwC8AMEAxgDLANAA1QDbAOAA5QDrAPAA9gD7AQEBBwENARMBGQEfASUBKwEyATgBPgFFAUwBUgFZAWABZwFuAXUBfAGDAYsBkgGaAaEBqQGxAbkBwQHJAdEB2QHhAekB8gH6AgMCDAIUAh0CJgIvAjgCQQJLAlQCXQJnAnECegKEAo4CmAKiAqwCtgLBAssC1QLgAusC9QMAAwsDFgMhAy0DOANDA08DWgNmA3IDfgOKA5YDogOuA7oDxwPTA+AD7AP5BAYEEwQgBC0EOwRIBFUEYwRxBH4EjASaBKgEtgTEBNME4QTwBP4FDQUcBSsFOgVJBVgFZwV3BYYFlgWmBbUFxQXVBeUF9gYGBhYGJwY3BkgGWQZqBnsGjAadBq8GwAbRBuMG9QcHBxkHKwc9B08HYQd0B4YHmQesB78H0gflB/gICwgfCDIIRghaCG4IggiWCKoIvgjSCOcI+wkQCSUJOglPCWQJeQmPCaQJugnPCeUJ+woRCicKPQpUCmoKgQqYCq4KxQrcCvMLCwsiCzkLUQtpC4ALmAuwC8gL4Qv5DBIMKgxDDFwMdQyODKcMwAzZDPMNDQ0mDUANWg10DY4NqQ3DDd4N+A4TDi4OSQ5kDn8Omw62DtIO7g8JDyUPQQ9eD3oPlg+zD88P7BAJECYQQxBhEH4QmxC5ENcQ9RETETERTxFtEYwRqhHJEegSBxImEkUSZBKEEqMSwxLjEwMTIxNDE2MTgxOkE8UT5RQGFCcUSRRqFIsUrRTOFPAVEhU0FVYVeBWbFb0V4BYDFiYWSRZsFo8WshbWFvoXHRdBF2UXiReuF9IX9xgbGEAYZRiKGK8Y1Rj6GSAZRRlrGZEZtxndGgQaKhpRGncanhrFGuwbFBs7G2MbihuyG9ocAhwqHFIcexyjHMwc9R0eHUcdcB2ZHcMd7B4WHkAeah6UHr4e6R8THz4faR+UH78f6iAVIEEgbCCYIMQg8CEcIUghdSGhIc4h+yInIlUigiKvIt0jCiM4I2YjlCPCI/AkHyRNJHwkqyTaJQklOCVoJZclxyX3JicmVyaHJrcm6CcYJ0kneierJ9woDSg/KHEooijUKQYpOClrKZ0p0CoCKjUqaCqbKs8rAis2K2krnSvRLAUsOSxuLKIs1y0MLUEtdi2rLeEuFi5MLoIuty7uLyQvWi+RL8cv/jA1MGwwpDDbMRIxSjGCMbox8jIqMmMymzLUMw0zRjN/M7gz8TQrNGU0njTYNRM1TTWHNcI1/TY3NnI2rjbpNyQ3YDecN9c4FDhQOIw4yDkFOUI5fzm8Ofk6Njp0OrI67zstO2s7qjvoPCc8ZTykPOM9Ij1hPaE94D4gPmA+oD7gPyE/YT+iP+JAI0BkQKZA50EpQWpBrEHuQjBCckK1QvdDOkN9Q8BEA0RHRIpEzkUSRVVFmkXeRiJGZ0arRvBHNUd7R8BIBUhLSJFI10kdSWNJqUnwSjdKfUrESwxLU0uaS+JMKkxyTLpNAk1KTZNN3E4lTm5Ot08AT0lPk0/dUCdQcVC7UQZRUFGbUeZSMVJ8UsdTE1NfU6pT9lRCVI9U21UoVXVVwlYPVlxWqVb3V0RXklfgWC9YfVjLWRpZaVm4WgdaVlqmWvVbRVuVW+VcNVyGXNZdJ114XcleGl5sXr1fD19hX7NgBWBXYKpg/GFPYaJh9WJJYpxi8GNDY5dj62RAZJRk6WU9ZZJl52Y9ZpJm6Gc9Z5Nn6Wg/aJZo7GlDaZpp8WpIap9q92tPa6dr/2xXbK9tCG1gbbluEm5rbsRvHm94b9FwK3CGcOBxOnGVcfByS3KmcwFzXXO4dBR0cHTMdSh1hXXhdj52m3b4d1Z3s3gReG54zHkqeYl553pGeqV7BHtje8J8IXyBfOF9QX2hfgF+Yn7CfyN/hH/lgEeAqIEKgWuBzYIwgpKC9INXg7qEHYSAhOOFR4Wrhg6GcobXhzuHn4gEiGmIzokziZmJ/opkisqLMIuWi/yMY4zKjTGNmI3/jmaOzo82j56QBpBukNaRP5GokhGSepLjk02TtpQglIqU9JVflcmWNJaflwqXdZfgmEyYuJkkmZCZ/JpomtWbQpuvnByciZz3nWSd0p5Anq6fHZ+Ln/qgaaDYoUehtqImopajBqN2o+akVqTHpTilqaYapoum/adup+CoUqjEqTepqaocqo+rAqt1q+msXKzQrUStuK4trqGvFq+LsACwdbDqsWCx1rJLssKzOLOutCW0nLUTtYq2AbZ5tvC3aLfguFm40blKucK6O7q1uy67p7whvJu9Fb2Pvgq+hL7/v3q/9cBwwOzBZ8Hjwl/C28NYw9TEUcTOxUvFyMZGxsPHQce/yD3IvMk6ybnKOMq3yzbLtsw1zLXNNc21zjbOts83z7jQOdC60TzRvtI/0sHTRNPG1EnUy9VO1dHWVdbY11zX4Nhk2OjZbNnx2nba+9uA3AXcit0Q3ZbeHN6i3ynfr+A24L3hROHM4lPi2+Nj4+vkc+T85YTmDeaW5x/nqegy6LzpRunQ6lvq5etw6/vshu0R7ZzuKO6070DvzPBY8OXxcvH/8ozzGfOn9DT0wvVQ9d72bfb794r4Gfio+Tj5x/pX+uf7d/wH/Jj9Kf26/kv+3P9t//9wYXJhAAAAAAADAAAAAmZmAADypwAADVkAABPQAAAKW3ZjZ3QAAAAAAAAAAQABAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAAAAAAEAAG5kaW4AAAAAAAAANgAAo9cAAFR7AABMzQAAmZoAACZmAAAPXAAAUA8AAFQ7AAIzMwACMzMAAjMzAAAAAAAAAABzZjMyAAAAAAABDD8AAAXd///zKAAAB5EAAP2R///7o////aMAAAPbAADAeW1tb2QAAAAAAAAebQAAdysABNiJ2KNsgAAAAAAAAAAAAAAAAAAAAAB2Y2dwAAAAAAADAAAAAmZmAAMAAAACZmYAAwAAAAJmZgAAAAIzMzQAAAAAAjMzNAAAAAACMzM0AP/bAEMAAwICAgICAwICAgMDAwMEBgQEBAQECAYGBQYJCAoKCQgJCQoMDwwKCw4LCQkNEQ0ODxAQERAKDBITEhATDxAQEP/bAEMBAwMDBAMECAQECBALCQsQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEP/AABEIAXMA7gMBEQACEQEDEQH/xAAdAAEAAgIDAQEAAAAAAAAAAAAAAQUGBAcIAwIJ/8QAWBAAAAUDAgIEBhACBgYHCQEAAQIDBAUGABEHEiETCDEVFCLRQaRWYfBRVbOxNDUyo9J1IyZlFpVTcxdygUKiCTNSoRiRcWI2RXSEw+EZJCU5V2N2l8LV/8QAGwEBAQADAQEBAAAAAAAAAAAAAAEFBgcCBAP/xAA4EQEAAQIFAgMDCgcAAwAAAAAAARECMQMhBHEFEkFRBhMWotIUByJhNURTVHOywjIVgYKDQpHB/9oADAMBAAIRAxEAPwDp3o//ANrf+H/8y+ufRX+L/wCf87mX0i/hv9/5HcPo86GoylUEk9a9LdQD0e6i1VmjuPhHpkjLGKUUlTGRIJxT2CcxRJkBMCeclEwDtfqTr05W39n0rcZXtouiJi6+ytIxikzStaRNfCtNaNd6F0aMzP7+pZGZ7KbZpMW3Ur4TpFaU1injTwqvNQOjvSMf0ZqB1BoiOlpGqqjnBYfdidUz5NbvApEKgADgxQQJgCgAjvPuz4O35OnepNzmde3Oy3d1tuTl2V8I7ZjtrPd5T3TWvlFKa1+nfdB2+X0bb7vbRN2bfdTzrE91NPPSKU85r9nBlMac1bVVak0/ZRvc5rmKproyJwaA0BEpjLGWFTHLBMpDmNniAFHgI8L23ddT2202nz266tmlJt+tWukUpjWZijWdvsNxudz81ttpfrWulKY1rhSMWXyPR2q5rrKbRZjMQz5+RBJ2pJkXMVgm2M3K4MuZQS5BMqZsiOBzjhnIXjcr1Jtr+l/3W+2622sx20+tMxdNtKVxmft5ZDM6DuLeo/26262bqRPdX6sRTurXyiFdqJo6tRVOx1awVYwtW01Iu1I4slGc0oIvEygYyKqapSmKYSiJijxAxQzw4X+/TetRvs+7aZ2VdlZtsRd23U1tnSsTEzE+U+U6Px3/AEqdnk27nKzLczLumY7ra6THhMTET9secMEeRsjHlbGkGDlsV4gDluKyRiAsiIiAKEyHhFESmDcHDID7V5ezNszKxZdE0mk08J8p8p+xjL8u/Lp3RMVisfbHnDAtWP8Aq43/AO+k97Uvnv0m/dGX+5H8N7dvQH3nf+3P8VrDdNNPKj1YruF05pIjc0vPOQatAcK8tLfgRyY2BwGAEeq+GOvOwuonQYjNKqBqebqrpEUQ/rGno/tD9KQR++LmICyaZxUOYxDJAXmdYpcR6rDqpYdpOhR0NIXpTSb9zUOp8dCR8SOF4pkqQ8w4DAYUKmcNqaWRAOYIH4ht28cgFt/uBIf7zH9AP+8DQ/I2d4733kO/bd2O7d0zjvePC5XM+b4WfJYVPTY6GkL0WZRg5p7U+Om4+WHCEU9VISYbhgcqGTIG1RHICHMACcR27eGRDq3Yd4uhF0H9NNf6RjK1r17UzgjuVfJKJxTgiDRskzBsPJcG5ChhUXFwO0OYiIJkOYoiIAFhxb04+ioh0W9RmLGGnkpGAqhJxIRqXLMmqyKVXAtzAY5xOBQMQCqCbJuOQyAiIdb7DJ9NNPZzVSto2hKdcR7Z5IiqcXMg5K3atkUUjrLrrKm4ETTSTUUMPHwSDgBHhYd9ab/yey1BAR06n0l41dKRbJukVo2nO+NVU1CgYh0Vu9lBUhiiAlMBQAQEBCxQqT/JvnmEC/e0xrw2lpRBA6jVi5psWibhQAyCYrA6U2Z6s7B67D847ozXTKhYCsS1PKVXUj+EhqThSzL1ePiySDpQp3zRmRNNE66BBHmPUxERVLgpTCGRwAwW3YHRr/8AqzqZ/wDrxh//ALVhvw+m2i1YDJRlEao1q4mWkNKTLdCVopozarFYMV3iiZ1kpRY5BMm3OBRBI3hCUBwGRAOJboXBlNPUE7qCLllyvUmcjHvGrJFi5KKZnKypVzcsDDwKoHIHBTY3COM5wAhjK6CzZZRs5ROkqkYSKJnKJTEMA4EBAeICA+Sw+ONhyNo//wBrf+H/APMvrn0V/i/+f87mf0i/hv8Af+R+uNBVZqNWc9AUFRfSph6gVVphaYkX7enW66jYSHQSSKICYMHMZYwmBUAOHL8IoCbhheobPY7HJzd5uunXZcRmRbbbN90RNYumfDCKadtY10nRl9lut5u83L2u230X/Um6ZiyJphEf5mutddNY1YbowCSlAUoNRdLin4N7S8k/XbxLtBgUzVxvcIG5nPOVRTwFVRKIgABzeGcFG8p1usbzP9h026+3Mttibom/WKW3adsTEaxFeNcZY7pNJ2uV7bf22TlzdMWzFmk/WjWsxM6TNOeHUbXqRcSWsNUPl9QEK0UUd7BnWyQJJOygmUobSl8ECkAAT8HJRAmSiJRAR6V6fyrcvpmTZGT7GKf0TNZjWZ18azjrrrrq0PreZOZ1DNunN9rr/VGkTp/8w00000c0PK9oU/SQmk3lWRyUJVlDpUuM0iqVZuyWXiEUuYY5BEAAihdhhz4PHOMDjVbOn7yOhZc25czmZWdOZ2TFJui3MumlJ841jz8GxX77az1i+LsyOzMyos7sYiZy4itY8p0nyYxUQ0jpHo/F6cTk3TtcSUhWCdRP4+GlRXapskWxkSpncpDkiioqCPg8QKHkvIbb5z1nqd++ybL8m23Kmy2662l03TdE1i2cYtp46VfFuPm/S+n27TNutzbpzO+YturHbFtKd0YTNfDwa+v2pWlFWUtRsZSWn7BCRb0uzbleozDpY0TscrmMy5Zx2qCADu3nyb731Bj36e6X1HZ7jPzNznTNs5l00m22O+ttsd9Y1jypGmjx1vqGx3WRk2ZGVEXRZbFYuunt1n6tJ0nmddXVLVj/AKuN/wDvpPez3ifpN+6Mv9yP4b2S9Afed/7c/wAVrLuiZozVVVK1JrU1koWPpnTuPeLSy757yVBFVk4KQqRQAcmzj5wlAcgACI8L4Y68q9PyaI0roDWVVyepbxbUafZqU+xpRGNUBNNAzhucXCjgQ2CG1Mw4AQ9rAjYcG2Hb7/L1m+iZTlcmmtc5iRi6raqGNBu3rgUIdIokwImOmIGKrgTB96PKwP8ArYsOYv8AdP6PP9K/9Nf9F+qf9C2/n952G5Ped27vPIz2l2dt483buz4WeXxsOHf8wqc6JlR1yE1oZLyMpVbpQppx2ycCvDqlAmAEp1BExlsAQPuh5WA/1s2HUGw/ZTodURof0UdAI2oa3rOJhqgq+EZVBPSEg/KgZFJ0QxmrdPIhswUqhSgXwlDpKiGdoAUqthq96KOrWh0jpp0gukXQVanTO5VbPDGVavYwqhspkaKvVFHLhRIR2lVyY5ygUqgHybcR+TNdUo+oOt6hoaSUKd5Tsq7iXBihgDKN1jJGEA/5kGwzjozRUlO6pLwUMxWeyMnSNXMmbVEgmVcOFadkCJpEKHExjHMUoAHEREAsP0/Q0U1RnNJKQbMKQclcF0apun1G7pVJqslIoumiyrdRNUxTJnIRM4juAAASiX53Cw5BpPSmvorV2OqqQgQSi29ZVZLKuO9IDtaPGqJGym0D7vDMQwYxuLjJgALD8K7DkjRySpgkdqDStT1bH00FWUunFspCQbulWqbhOXjnm1QGqKyoAKbNUAEEzBuEoDgBEQDmro2f5fdYdIaMqmo4+so9tTsWms1gppJq47rNyBQ4AmVdNJYrco5KdQyYCBuAFMIGwHHlH0cy0UqOqF9T60iIKo4mDqan1qUWZyJ5Mzp3Eu2aAlORqLQUzHcpn3i4ABTyYM8AEOELCzphen2lSxDqrGDl9CIvkFJNq2V5ay7QFCiqmmcfmmMQDAA+QRAbDuE/qzoyupCbTiKCqJJ2er4EsOZaTKqLBiCSgCycm3Kb3YlI9KmqIqikKyACoHJNuDrFre9oOQ1ZqZ3plT0tB02d6IM4+Vdd5doCBQBUFFN6m4RVBQ3zz8BANxsZEMHCwzjSycjI4ssd65FIuWwcUzj183HUH/RH/hfRvQHXen9E+cfP8zs7+yml01p3VwifOGjetOkb3q3sPmdnd291dYile2mMx5S7E9HvpUR3R+rV1WEYzbS/fY1aNVbLgskGDmIcpwMUg4EDpkEQwOS7g4CIGDZvUfXPTfqLaW7XM3c2Uui6sWXzhWJinb5TPE0nXCcB0LpHXeh7mdxZtourbMUm+2MaTH/l5xH+P/b1rvpXRVe6SU3pdIwsWirT79w9GXTQUFwsVQxxBIA2fdlyqbdxHcJUxwG0d3jYda9OdP6lm9Qs3l0xfbEdvZfSKU1/p1nTTCmuNdPW96V13e7DL2V+1iJsmZ7u6ys1rpjpjr56YU14r/WdNe6X0Kn1b2L379P/AKj4L/ksH7n9a/J+Kz5R+s6a90voVPq29+/T/wCo+C/5J7n9a/J+Kz5R+s6a90voVPq29+/T/wCo+C/5J7n9a/J+Kz5R+s6a90voVPq29+/T/wCo+C/5J7n9a/J+Kz5TF9QpqMnIVFpFuecqR0VQS7DFwUCHDOTAAdYhel+uvUvS+s9OsyNjm910XxMx23RpFt0eMRGMw2r0f0HqHS99fnbvL7bZsmK1tnWts+Ez5OPuz3oAIAkOB6w3Bx/23yh0iqOznn8H/EHjtQT2c8/g/wCIPHYq+27aTaLpumoqIrInBRNRNTaYhwHIGAQHICAhkBC6Vdp//aOdLL+i/wDo6/UbPvv+j/U3IDtbkYxy+Zu2bv8A7uzmeXdu8K4VdWHDaUdrqOnQqLLLHFRRRRTcY5hHImMIjkREciI2oPjs55/B/wAQeOxVyrXGuNTV8vQM5UFMxzufoVoSMBd2RJwxkGKCoqNEVmZybDcsDqJmMYxuYnywEAEomPStWI07UIRz2myT9JMJKKgpgZRwg3Ki0dv0zGRFRuo6AhjbMI4IAgYExUUEA8IbhVX1jLz1b1dN1pMpFGQn5JzKOhIIbecuqZQ+OPVuMNqDSi1J+Dkm0xCO3TB+yVKu2dNVxSWRUKOSnIcogJTAIZAQHIWKuwkf/mB9NeMZJMG2sjk6aBQIUziHjHCggH+soogY5h9ZhEbtCrWqPp49Muq4J9Tczq+6MxkUDt3BW0XHNVDJmDBgBVFAihMgPWUwDYq689nPP4P+ILlBPZzz+D/iDx3Uq7BUt06ul7RNORtI0pqWhGQ8Q2IzZNEaeiQIikQMFKGW2R9YiIiIiIiIiObUWrjTVvVjVXXSo0qu1SmEJmYRbFZldkj2jQ5kiiIlKfu6aYHxuHAmARAOGcBixVg/Zzz+D/iC5QT2c8/g/wCIPHdSq9gakqamoeTh4giaASiiJ1HAAHOS5ZVS/dmz4AmKscBEOOBwAgAjktVD2c8/g/4g8dirVXUBuuq1WAwKIKHRUKBBHBymEpgyHAcCA9VqCypni3lc/wCuz+BxdRZWCwt2lKzD1n39uDIUMBuMeQbk25zgDAY4CURwPAcWFSIYEQHr8thFgsN6KhZScXFtFMzuDlLuNgQACh6xEQAP7R42GlYRYLBYTYRYLBYTYRYLBYTYRYLBYTYRYLBYTYY3LDiblftF378eyLCmOLeV/mM/gcW8VWdk4PZ1WVcR66BKbl0FFiFUVWaiQgmADHABUzgPLjIf8bIzOUkId4q3QTeNUWB3rczRU75Jbu6YZ+ahy8phjgYDjjOM7uuw+JCWbNxbu+0URfJMHxBOo+ScqAbwRSATkACiPERKAZx1B1cAr5CoRkWTpo7kkVk1YVFQSiYvhuwOnkw+2pjdny4zZVDR7sjSomB13IIoAuUygnPtJwAcCOeHDNkUtgscHs6rKWShYLHB7OqylkoWCxwezqspZKFgscHs6rKWShYLHB7OqylkoWGNy3y5LfaLv349hY0v8Xlf5jP4HFpVZ2RNlRwshYLCbKjhZCwWE2VHCyFgsJsqOFkLBYTZUcLIWCwmyo4WQsFhNlRwshYY1L/Lkt9ou/fj2FjS/wAXlf67L4HFlWlg9WLI/RPot9GPTppouw1Br3SZ/Nyj4608Kb97GKouGzJqY6BEN4eAk4VdJpmIYcioiXmCUobRiuLKZ6L2gkqrBU1KS2oCNR1bSkrWsWZuuyOxaskTOe7NlzAkImW2NhFQ5RKUDeCBQ3AJaPBTom6KU/pXAyVcauFiKxqijCVawM4mGTdkkZdMyjZqZocveFQPt2CqQ4ABh4FMADcFeh0a9F3NHQsaSfrIldz2mTnUJuYTNTRSYoEXOLcxeWCo7+7KABgN4GAEd+7AUWNU9E3RCitMUVql1fKxrx1RyVUIEcTDFJoo5UT5qbErMS94NuL4JVwUwJhAdmOFjFgh9MNAKQ0HoTUmv5Cu3lQ16hLi2ZQyrNNq0MzdnQKqoKqYmMUfu/AAQEcHHcXgAhmMj0TaFDRyfqMrqfgq2pqlWlTuo2RnYx2KqZyomOB2LcvPaFMVYDJiqcTYxuKURxcGJV7UMrVvQ6oKRne6ruYesZCCarpskUTkZIR7MUkTGTIUT43GHcfJhzxEbVHXy6mJYLKerFkLGJYLKerFkLGKxp2Rj4eej5WVg28yzaOU1l45wodNJ2QpgEUjmTEDgU2MCJRAcDwGyu4M/QOnmpPSl6PcU8oWnadha1o6CmJeJhGQM2ayyneVVCbS+EO/llTERMJxLjJs8bguOkvpRQdaab0tIsCae0bXEVVbylaids0EIiFTWBmL0zXekAkUFsApNuaIZMoBw4hjAcB9JjQCG0UnEU4Cu6flmSzWMEGSMuVzIkVWYJrKrHTKQu1ATicSG8pDpdec3RwjZCynqxZCxiWGNS3y5LZ90Xfvx7QsrKl/i0rn+Iz+BxYWdgsM2DWfUotCf0aFqUS032eMWDIGiAYai976KYKATmBucYOY27cbBSiIlACgHOOk/S9jdLtD1aGSka0kJ0sPKxbNisjGjEtjvDKACpFxSF4UhCnKcUN+wypRHIAOAhDiiL6SmsMVRaFAo1ExcxTNmtHshfQzJ26ZtVQMCiKDlZEyyRBAwgAFOG3+7iwqEtbNT0XUc9TqcSrxNNK0ezP3Nv8AdRChVSnbY2YNkF1Q3jlQN3AwYDFFv/vLaxHodLT11UbJ7Et4xSFbneQzJw8bx5ymIZsk7USFcie0wlACnDaHAuADFhhszXFUVBTNPUfLyneIilSOk4htyUyd2K4WFZYNxSgY+5QRN4Ymx1BgOFhnz/pXa8SdHvKFeVmgpFSUYSHf/wDwdj3l40IUCJprOeTzlBKUoFKYT7gDPHiNhilN6u6gUpRkxp5DTSIU5PGOo9j3Ue2dpiqdLlCqnz0ziirs8HmpCQ4YDBuAYDDrCbCLBYLCbCLBYLDbipN3CyjOZYCkDpi4TcoiqiRYgKEMBi7k1AEhwyAZKYBKPUICAjYckVn0ntba/VgHNS1a1O5pZwg5hnLKEYMV2J0M8kE1WyCZwIQTCIJ52APHGQCwq9UtddUNZu4l1CqFJ8jGnWWbINo9syRKssIGWWFNumQplDmABMcQEw+3jhYYhO1BN1NIDLVDKupF4KKLcV3KoqH5SSZUkiZHyFTIQoB5AKAWGhYRYLBYTYYzLfLkt9ou/fj2gWVL/F5X+Yy+BxbxFnZOD2dVlZlQOj+o+p5DqULTCsoRN82jDGKukkHeVyqnSTyoYuclQVMIhwKBBEwgGLIw71WEWOD2dVlZLROn1R6gDOlp1JA405CO6gfc1UE9rRuBRVEufnG8IMF8tkoxqwWOD2dVlLJQsFjg9nVZSyULBY4PZ1WUslFvSVKT9c1JH0jS7EHkrKrA3aoCsRIDnHjxOoJSFDACIiYQAADIjYZPqhoZqVo+hFva3hmybCaBTs9+xkG75o4MmIAoQFW5zk3lEQASiID6sWOGA+zqspZKFgscHs6rKWShYY1LfLkt9ou/fj2FlS/xeV/mM/gcWVZ2RNlfotov0idJdJ+i/GM0tVKiCRawj+QNGISUcL9q7cKkYJoIJj4QimYV3iZDAIlIO9TICULg4MadJasKH6OMa5oSvWzOspuvZmRlnAC3UlO7nQbGAxyiAmImqpuEwgAFOKeOIAIXUc26cVRp0z6PilOTerUHMQUpps+Mu0masYJA2nTpKG7g3hwSBQFU1MGK4OcTmES7R4lC0rDD2etkGemKT0mc1xTo0a60MepyrE67YSBOgk8FFNQ48SuimTb8sgiBwE4bQyfiGXsNRYpHRWoG8VrBQrPTt3omaIi6VNLs0pIlRd3IC5TN/BWMuY4LiY3HmcxPAG4CEFI8rqlDaFrtzaj0WfTA2kica0pEr5sMoSrQIUOYLYABbng53KitjaJBzjFhnOqPSFpSpYGu6RW1TpV/DOkKtj2rUJBmcijdOn2ho8ieB4h3wVuUJfnKgYC5MGAsng/NKwjhZCwWE2VHCyFgsJsqOFkX1B0slW1YxFKOKjiIBGTdEQUlJZyVuzaEH5yiqhuAFAAHy8RwHlsrnjpVtYmk6TpXS3TmqaRlaCphy47s4jKlZSUhKyCoAK79yi3UMKBDAQCpkH5pQABETGwEHWq6I4WQsFhNlRwshYY1LfLst9ou/fj2FjS/xeV/rsvgcWVaWD1YshYxLBZT1YshYxLBZT1YshYxLBZT1YshYxLBZT1YshYxLBZT1YshYxLBZT1YshYxLDGpb5cls+6Lv349oWVlS/xaVz/EZ/A4sLOwWHafSLoVNa+i4AlQ1dLMZipmbR+kmwj2ijOJbvDGBid4u4doidRYCHUK3QKorywA2MiBbg48l+i9WNNUOpXVYVfSFPoqHlE49i/fLA6klI9VRJwRDlomSA3MSMUhVFCCccYzkLo+nVKacyvRVHUKKpJ1HVXC1azgXsgaUOuk/SWaulhMCAlAqQgKSYcBNnAjkM4tUeVLdGKrq309fV9SdYUjKHjIpeaeQqDxcZBBsiAmU3ZRBDmFKAm5fO346iiOAsNVz0dKhidPmNe1TXNFU6eYiVJyJgpSTOnKSLIoGEiqSRUzEAFNhgTA6hBOIYKAjwtiM01K6Lq0Vp/Sep9PnbQlMOaCjJuWlJp2cqLyZcKOMs2gAUxlFjETIYEylEChkxzFKObI3taOiMpTsWertPajp1wzYUdE1Q/p80odSZSbqoIg4dikKewEgXUEcb8gUQHbgQtVWGznRU1AgqDc1q5qGk13bCFaVHIU23kTHmWMa4EnLcLIcsCgXCqYmADiYoHKJgDNhuatdHWmtOdL6Sr2N1hpaZdTseu7VZoKuhM8MR6duAsgM2LkhSgG8VRIO4im3IYzBwbdEWCwWE2EWCwWFjTraDeT0e1qaTcR0Ss5TI+dt23eFUEBN4ZyJbi7zAGRAu4Mj5QsOT+ktphp9pjUFIF0yf1C7g6qo+OqdI06KHeymcmV8EwIlAhQAqZfBybAiPhG4WHD9gsJsIsFgsJsMZlvlyW+0Xfvx7QLKl/i8r/MZfA4t4izsnB7Oqyu52m/SM08lKLpZKdqKlIiephOGA0bV0TKOY9R9EJqJMJFqtHCJyqAgcqaiSxBIYSAIeuSMKhul6xpykKtgUaOmH8lVqUuhIJKVQqpTiqz5VQ4uyRiiIiRQgHKBcKgI7AMYc5C6OM6A1agKe04qPSyt6GWqSEm37WXambSox67GQQTVTKqB+UoChBIsYDEEodQYEBsjmGnenK1g9OWVHLabSq75lRK1EE5FVKt4kEjpHJ33s8ERILo28BOcTDu29YCOSyVwce1JrpQNf6fQULqFpQ6kaupSmwpeHnWU+ZqgLVIpwamcNeSbmGR35DaoXfgANwDF0XzjpfLzVDx2ldWUH2xRLSjGdNKRJ5XaZORanVMjLtVOSPdlw5oFMQCnA5C7TiYMbRVv1Z0vKWmaYk/0/o6rDVnM0S1oJ7OmqAzhE8cmVIqpwbcgoAooRECZ3+CX2+OSNGoulhDzNKTizPTFRnqHVVKNKOnKnGaMoi5YolQIc5WnKACKqpt0yGHmCAbcgHEQuYKwSe1cpiqdGab03nqBcqVBR6TlpD1A3meUkVuu7FydNdoKJuaICdUpTFVJjcAiA7cDRxfZCxwezqspZKFgscHs6rKWSjbilo5vKM3EuxVfMEnCZ3TZJfkHXRAwCdMqm02wTFyAG2mwI5wPVYcta+a20BrDF0o3pzSqRpZ9ScOzp5u5XqXtBNWObFU5ZDJ92S+83KZFQDYwGNvHIDhw17OqylkoWCxwezqspZKFhjUt8uS32i79+PYWVL/ABeV/mM/gcWVZ2RNlZdOaUV1TunVNarysNy6Yq5Z03i3pVSHBRRuoZNQpilHcmO4h8bgDcBREMgFwRUmlNc0lQtLakT8ODWBrLvXYy4rEE7gG5wIoIpgO8gZEMCYA3BxDIcboxGyMmktPZ+K0/hNSnXduyJ+QexrQCqiK3NalSMpuLjAF++Jgc8ePAPKVjPCyMm0/wBPZ/UmXewtOC1Bwwinswr3hQSF7u1QMsrgQAcm2kHAeUccQ67KV3p7P6duYZrUItRPPQbCoGnd1N4d1dpAqluyAYPtHiHHA+UbIxqyo4WQsFhNlZNB6d1DUNCVRqJH917JpFaPQkd6u1Xc8OoRHYXHhBlE+eIY4ddkYxYLCbKjhZCwWE2VHCyFgsJsqOFkLDGpb5dlvtF378ewsaX+Lyv9dl8DiyrSwerFkd/tM4SP1k6MOk3RflJBqwXrSInJennrgomBrLsJtybGA44UaqOiiPHqDHXcXFmJ5WL1cqTSJrQMwyi4KlJ6rIelQPHtn6i7KNj2SKBW6TjCSjhXYZQhlBACmPu/ugFhk1aOpmkUojUl2wlk62aaT1w4Ud1S1YKynMauGajMXRW5eQYyYKbilEBECmAD5HdYcd6FVa3rvRqmp2pplo51kqGoKoNQsrOIEVYBNCkyyZQoiBAcGKBSoGMUSFOORKJthRo64dFylKrmelMhFVBKmiqoj1pRy7CSjkXzxWQSSVFRFNB0IJHdmPu2ioOCnDdxEoAIxdvNS4xylL0HP1GynUqlf6baht5JxURWYSyiaLTLcroWgAlkpFREodZSnADeFmw6e9JhoR/V+kzBR43alcaZ0eiZdx/okgMyIAnP/wBEM5H1Bcgl3I1+pKXbaEVzHVe1fTiVOTNMjTq86wiY2FUy+SSVPGpNREyDU6agFOZU2Np/IIHskuMOnKzqiY0iCp6nJM0yVvVCTdnTFQNI5UE8t1M9jPmu06jIhdoCQxdo7imzuL4VWXH9LamSVC9F7Smme1iR1NVhWE2xqsxEExVcRQHZFXR3iAmKQyap9wFEBHBePALg7Ja6Ryc/GSVKVBAumVOvKwgG1GT06WDGBikzviAU8cihsUcNztjG3pmEwbMioJfDNYbOrVPw4QdHf07ITThjEavRbMruq2cW2TBgdNcDg3Ta/wCijlDplHaqYQEpM/3RwHGmup+kYPRk1jL0gGzVFIlTQ6dOctNsQ3cyulclT5PEWwAKfKE3tqYHO66S/PqyFlPViyFjEsFlPViyFjEsFlPViyFjEsMalvlyWz7ou/fj2hZWVL/FpXP8Rn8Diws7BYLCQHA5AeNgERMIiYRER4iPtjYRYSAiA5AcCFgERMImMORHiIj5RsIsJMYxsbjCOAwGfIFhJjmMAAYwiBQwGR6g9r/bYRYBMYwAUTCIF6gz1WAxjGHJjCI4xx/2WATCbG4RHAYDI+SwWEWCwWE2EWCwWE2EWCwWE2GMy3y5LfaLv349oF7Q7mPbt5nv8Z3wDHY7Q5xk9vBz7XX5P+FvEZB2nT3ox56fxWTg7Tp70Y89P4rCe06e9GPPT+KxRHadPejHnqnisHadPejHnp/FY4O06e9GPPT+KwntOnvRjz0/isUR2nT3ox56p4rB2nT3ox56fxWODtOnvRjz0/isJ7Tp70Y89P4rFEdp096MeeqeKwdp096Meen8Vjg7Tp70Y89P4rCe06e9GPPT+KxRHadPejHnqnisHadPejHnp/FY4O06e9GPPT+KwntOnvRjz0/isUR2nT3ox56p4rB2nT3ox56fxWODtOnvRjz0/isJ7Tp70Y89P4rFEdp096MeeqeKwdp096Meen8Vjg7Tp70Y89P4rCe06e9GPPT+KxRHadPejHnqnisMFmzEPUMyZNPlkNJvBKTOdoc8+Az5bDfpf4vK/wAxn8DiyrOyJsq5ZU2k9jjyf6ii0U0tgKlUBfcmJs7QHakID80eoRuCuVjJFBNFZZg4Ik4/0JzJGAqv9URDwv7Lo+zw0um5KzUinhHBi7wSFAwHEvtgXGceuyDiGl2iSizqKeIppH5ah1EDlAhvIUREMAPEOA2V6RcQEimqurJM2SKRiJio4E2DHNnAABCmEeoREcYDyj1WRrv2LiMfOI92UCrNlDJKAA5DcUcDgfLYa9hNlRwshYLCbKjhZCwWE2VHCyFgsJsqOFkLBYTZUcLIWGNS3y7LfaLv349hY0v8Xlf67L4HFlWlg9WLItWL1sjASjJVTCzhVsZMmB8ICCfdx6gxkP8AjYxZbIVRBO3QLd+QRau3rddQrdNyDlEpM8RMY2wglzj7sByHVjhZXi8qOHRbopNJBAFUmT9Hc1K42gdUC7AAyuTDnjkeAZz1dYwV7io27hsugrIKKFPBIsylMBxDnFUIO3q8m03Hq9d1GjSoQqKyz+UkW6C7cAFok4SVOmdT/WNsKbgXrx5Rx5M2XFUyBjKPnCh3pXhjqGMZcoGAFREcibwgAePrALI17KerFkLGJYLKerFkLGJYLKerFkLGJYLKerFkLGJYLKerFkLGJYY1LfLktn3Rd+/HtCysqX+LSuf4jP4HFhZ2Cw3F4mRbRzaWWamKzdmOVFXICBhKOBDgPAf+eM+Sw83rB1HKlQeJcs50yKgG4ByQ5QMUeHtgIDZGvZSwWE2EWCw9WzZd44TaNUjKrLGAhCFDiYwjgACw9kYxwumU6QpGUUcA2KjzA5onHq8Drx5M9WeFxHq/hXEdzwXcszGbqFSORNwU5twgI8ADrAMYEQ4AN2or7K9WzZd44TaNUjKrLGAhCFDiYwjgACw+zszkaA7MojgypkhT5gcwBAAHIl6wDj1+3m4jXuqWCwmwiwWCwmwiwWCwmwxmW+XJb7Rd+/HtAsqX+Lyv8xl8Di3iLOycHs6rKzZCRaoU5BRUqI9myCTlNcQDIpHBY2xUvrKI/wBoCYPLYouJFtIs3Mk2p8xVplBtGplMjgxxQBHBxS8o+EBM48mLIw+tQTLNAAgkDnuyAvATxtBzsDmfN4Zz148ubHDKKgkV5B/VsS+OBmTIpVkUykAOUYF0yiYvrEDGz7ebDZqtbu8dImRZOjR5BSNHLGFErZLBiiQyGPCNkuQEAyOBHPVYeosYqRcdjiCJQnzlnAP/AKhMkNt9WC954f8AKwxWnZAZPUBOTUTKPeHKy2wweDgSmEAx7XkscLaEfjNtod9PqJLqoSa6CR1ilAvFADJkN1Bt5m3gPAMjZW2xdzTF1BOKoUFvJjMETTMoBSKC1EAA4Gx/c3CGM8OvHCyUa7BaYaLt1JA6yb8KlRTVMf5+0yeMD6hKP/AbK82zlB+Z0vUC3NQ/UjQix1erlgCwYH/o4Dj6rI+lWtXvJNk1qIzRumaSAGqjhFMwlHAjhIvADJ9XD5ojtsLVVZ0yeU0+enfIOAljNzqPQTItyTAnkpgL1E4jgB9sfJiwr2Sa4Ksi1KUO89uOQP3rGBU7snyt2eGN2z1YsPWOLLGewH6rTEJMZgoIc0pQVFvt8LIB/d3bcf24scK6OlX0vHsHz5ug/XZzaSaCSuxMokMQxhSyOAAuShgB4BZWrXqDoEY908XegooZYoN36RCuUwDbxExfnEHPgiIB1DixRh9kLHB7OqylkoWCxwezqspZKFhjUt8uS32i79+PYWVL/F5X+Yz+BxZVnZE2VHCyACIcQsFhNlM54ZsiLBYTZTOfLcEZuoWE9fDjZTORznObgjN1EjxHj12Cymcj15uCLqFhNlRwshYLCbKjhZCwxqW+XZb7Rd+/HsL2h3Me2bzPf4zvgGOx2hzjJ7eDnPV1/wDpZWQdp096Meen8Vg7Tp7q/S/np/FZDtOnvRjz1TxWMTtOnvRjz0/isHadPejHnp/FZTtOnur9L+en8VkO06e9GPPVPFYxO06e9GPPT+Kwdp096Meen8VlO06e6v0v56fxWQ7Tp70Y89U8VjE7Tp70Y89P4rB2nT3ox56fxWU7Tp7q/S/np/FZDtOnvRjz1TxWMTtOnvRjz0/isHadPejHnp/FZTtOnur9L+en8VkO06e9GPPVPFYxO06e9GPPT+Kwdp096Meen8VlO06e6v0v56fxWQ7Tp70Y89U8VjE7Tp70Y89P4rB2nT3ox56fxWU7Tp7q/S/np/FZDtOnvRjz1TxWMTtOnvRjz0/isMFnDJnqGZMmnyyDJvBKTOdoc8+Az5bQst+l/i0rn+Iz+BxYWdgsLtlTSb2OPJ/qGLRTS2AsVUF9yYmztAdqYgOcD1CNhXLRkigmksswcETcDhE5kjAVX2toiHH+y4Po8NMJuSs1Ip4Rcxd4JCgYDiX29uM49d0HENMNElF3cU8RTSPsUOogYpSGHqKIiHAeIcLD0jIkkgmostJs2SSZik3ODG8Ixs4ACkKYR6hyOMB7fVYeEgwcRj5xHOygCzZQySgAOQ3AOB42GtYLBYTYRYLBYTYRYLBYTYRYLBYTYRYLBYTYYzLfLkt9ou/fj2gWVL/F5X+Yy+BxbxFnZOD2dVlWrF61RgJNkqphZwq2MmTaPhAQT7uPUGNwWRlr+qIF46BbvyCLV49brqFbkcg5RKTPETGNsIJc4+7Ach1Y4WHi8qOHRbopNJBAFUmT5ETNiuNgHUAuwAMrk4545HgADnq6xVFe4qNu4broKyKqhTwSLMpTAcQFYqhDCXj7WDcer12FfTKrdqsZ4SZbx71E5RTF02FVI5P73UQwgYBxjh7fEBsUac+5ZPZt67jgP3ZZcxybxHIgI5zx48R48eNhX2OD2dVlLJQsFjg9nVZSyULBY4PZ1WUslCwWOD2dVlLJQsFjg9nVZSyULDGpb5clvtF378ewsqX+Lyv8xn8DiyrOyJsqOFkLBYTZUcLIWCws5Gmajh2DOUlqfkmTKQICjRy5aKJJOCiAGAUzmACnDAgOQEeAgNlVnCyFgsJsqOFkLBYTZUcLIAAiOADI+T12H0YhifPIIZ9sLCLKjhZCwWE2VHCyFhjUt8uy32i79+PYWNL/ABeV/rsvgcWVaWD1Ysj9LuixSFBaadHmPr2TYaehJOknFVHfuKidAmuLNMW7Ay+Q2pGK8eKIqFKG0olAQA5wDBcXHtC6B6KVAwpxofQt5KtasoyarBWqmc1ICziXKZ3QIx5fCAhyo8pMgifKhjnIIiIZAQrXGhHRkpTSCk0KnZSjqoqxoMKlSnWjaVdLoP1UjqFTTI3KLMUUTE2KFU+825MIk4ZgqmukOhDqk6cokdNly1PUGj7uvBqQs053IP0U3JyFBuJhSEhu6mA4CHUYu3bgRGi3rbQjow0LpPHxUkwllqoltP0qnZz7dtKuFFX50OeAgCZRZAzDGw2Q3kLkTGAQyMHGL+M0M066OemdWzekA1TVdeN5zvT1eedtEmhWr5RBJRNJIwFMpgS/O8DCfEphMIhRyZM9GfTVHRGru1aMj4itaQoxhUSjyJey7kwLKJoqbXKrgoMTiqRQwim3AdggIAY20RuDiupX1V1d0KKTdPXkrMpU/XckwA6qijkse1LGtBRRAREeUmAAfaXgUMDgOu1R15upiWCynqxZCxiWCynqxZCxizrQuplKK1jo2sUoN9MjBzLaRFgxT3uHBUTgcxEwDy4KNlwc49Lg0xX+mVE62Pasr9RlKS0lGtoCs1ElF2ZgKmdRZoomRMDtzbSFERIGBIUMjcHVT1YuoWMSwWU9WLIWMSwxqW+XJbPui79+PaFlZUv8Wlc/xGfwOLCzsFhdjW9Zmghpc1XTQwwtytBjhkFe6igVcVypcrds2AsIqgXGN4ibr42HMGnfSreaZaSO9O6cpaRLKO4+Qjxkj1U/7kXvfMKdwEZu7uC5UlNhThgPBAwlE2RGDjOH1g1Yp+ll6IgdS6pjqeckUIrFtZZdJqcp88wopFMBcGyO4MYNnjm6KwtdVuRVsuSsZwqjOMPCtjhILAKMecDgZoQd2SoCCigCmGCCBzZDiNhZs9YNV46kFaAYal1Q2plZI6CkOlLrkZmSPnemKIH2bDbh3FxgcjkBsMfeT05IxkfCyEy+dR8SVUse0WcHOi0BQ4nUBIgjtTAxxExtoBkRyPGwyJfWbV51TRKMcap1cpAJtRYlizTTkWnduH3PK37BT8EvgiGOAcLCqg65ramIyThKbrCbiY6aRM3kmjGQWQQepGKJTEWIQwFUKJREBAwCGBELCjsJsIsFgsJsIsFgsN+CnpumJdrUFNzD2Kk2R+a2eMnB0F0T8Q3EOQQMUcCPEB8thZ1pqNX+pD5GS1ArWcqN02TFJBWUfqujIkEciUm8R2hnjgMBnjYY7YLCbCLBYLCbDGZb5clvtF378e0Cypf4vK/zGXwOLeIs7JwezqsrmbSPoka16zxKU9StNnbRrh83Yt3b9Bwkk45pVjGWTMVIwGSTBA284dQmIUNxjYsUV2mnRs1U1GmlY8aSnIaNakkgdS72HcgzbOGbdZY7dRTaBSKCZEU9oiAgYwZDyWGFttO9QXtLLVyzoWoXFNthEFphKLXMxTEBwIGXAvLDA8OJuuyPBOiazVlGsGnSM0eSfNAftWZY9UV12opiqCxE9u4yYpgY+8AENoCbOAzZVLZKFgscHs6rKWShYLHB7OqylkoWCxwezqspZKLGnYGQqmej6biu798k3KbVAXDgiCQHObACdRQQIQvHiYwgABxGwzDWnRaodDqgiqeqKep6ZNMwzadaPIJ6Z00UbLGOUggqJCgYfuzDkuSiAgIGHNjhx97OqylkoWCxwezqspZKFhjUt8uS32i79+PYWVL/ABeV/mM/gcWVZ2RNld4dNelhobpr0c2lJRsU8VqJKEfncRRZeSICsk7VTZKARYCbEv8A3Ih3GSm2pmPtTHeJrg99MukJpQnA0lVE7rg8pkYGhJel5GjBZSDkr+RXO5MV2KhCGTNzRWTUMcw7gOmXPtgNHyj0nqId6QUo0pmvqOpxxA6fjSctBTdPyjp25XBBRNXkC3MDU6bkRKIipgSiO44jgACowWD6Q2nLTo5lkHkiv/THD00805i0zNlTAeEcLkUK6523lpnSQO5bkDdv8IBxjjZXVLhZCwWE2VHCyFgsJsqOFkLBYTZUcLI2opq0fSjNk/kko5q4XTSWeKpnORsmYwAZUxSAJzAUBERAoCYQDgAjwsOeulVLaT1NF6dPdO9W46qHVL0hFUk9ZoxEg0U3tSrCdyUzhEhBTETlKAZ35H5uMiEV18uiOFkLBYTZUcLIWGNS3y7LfaLv349hY0v8Xlf67L4HFlWlg9WLI9Dt3CSKbhRBQiS2eWcxRAp8DgcD1Djy4sYh27hNFNwdBQqSoiCZxKIFPjrwPUOM8bDzsraUi5NGOQllY5yRi5UOig5MiYEVVCAAnIU+MGMUDFyADkNwZ6wtVGrYxbUfFycssdvFRzl6qmkoudNuiZQxUiFExziBQHBSlAREeoAARGwP4uTijopycc6ZmcoJukSromTFRFQuSKF3AGSGDiBg4CHELK1fViyFjEsFlPViyNpCLk3LF1KNo50qyYmTK5cERMZJAVBECAcwBgomEpsZ68DjqsYtWwWU9WLIWMSwWU9WLIWMSwWU9WLIWMSwxqW+XJbPui79+PaFlZUv8Wlc/wARn8Diws7BYd6G9BJaz9BbTTTOn4ozuuYlnMVTT6SYAKjxunNrtnrYufLsXRVAA4jyfaAbgy/U3TajKki9FdFoamDVLT+nslU0NLFQliRaTpdk0aKv3SrlQBBuiDs6wnHGRKAgXwjBaoo5Do6dHJiMTqS5omNfwLnT+qahdQtN1W7eR6ruJcNykM3fKACvhlVMQ4CBilMA4A2MjR5UBpxpzq/0b4yvHlHqEgKOmqonmmn8TJqHeyhQTZADdJdU3OFFPG9ZQu5QCiAFDcYuIOrmgdFRmqWs7OIdUQMlDH75Iu4ptMBHIN2qSR1PvHi+8UkE8F3HMJjiUMAImEBujtejpJpvQ09Tleacx8LHo1lpxXhHjWCnV5eMBVm0UTBRBy4AFDbgUwYB4AYggGesYQ67dKBm4kao0qj2bdVwu60xpFFJJIMnUOZkQAKUPKIiIAF2o5o1V6NuisXpNV8u2pKPpiboGSgkHycTWKk9K8p25BuulIIgUG6SwZMYgI/3iiUeAeFDBhXSe0k0hhNPP1rorR8UrBs5tKPCoIaq1pAwonSOJEpJi5KVVo6MJN3gACYYEohkSiNFVRdC6OBoPQTmd097SrHUqppKmm02tMOW6MUQpmyZHIoEMBFDJi4AwFNgo+Fu3cMQcpaq9G3o7kSm6KoRjFpVbTlSRsPHMYmsFn0tPEUelauEnaThIqDNbBt5RJ4BRAQHIFERtRuVP0T9FarZUshT0RCUs+PqQxpCULA1grOD3RZJQ6hHJlSbEnhRSAABIRJkwgIDwxCjFKiktJ3vRg1zZaYaRvqHCJqOn452LiWcPQfkSdOASOYFsiksH3nMKUdvhkwAY40dNrCLBYLCbCLBYLCbCLBYLCbDGZb5clvtF378e0Cypf4vK/zGXwOLeIs7JwezqsrkGlNfdXKHd0g9pasFGC1BpPUKfMVm3P3RN2c53BRA6YgqBzKnH7zfjPDGAwH3SvSC1hotSGVputV2poB4/fsRM2QVEF3pSldCpzCDzgUKmTJVNxeGQABERsLepuldr1VyXd52t0lUAh38ARFKHYoJpx73ld5QKVNEoFKfkJcQwYu3wRLkckY5S2tmqVFJUwjStXOI0tHSLmVheSgkAtnLgpCrmERLlQpyplKYim4glyG3BjAJWvS2rVf0VqApqhSk4SLqNVdwudw2ZNyImFfdzSd32cnlmA5g5ezYAYAADAYDKqj6VevFVu2LyardNQ0ZHSMSzIjEMUE27N8kVJ0kQiaJSgByFKHVkuMlEo5GxVgtSV9V1WvoiSn5k7h1AxrKIjlSJERM3atCARuQOWUuRIUADcOTDjIiI8bI5Eqvpf8ASJrWCc03UGoQqMXqzZy6BvEsmqqy7dUiqKxlkkSqCoU6SY7927weI4zZVNqR0jtY9WoQtOV3VibyP74Egsi3jGjPvTsCiUF1xbpEFZQCiIbjiYQ4+URGwxJ3XVVvqVhqKcy5jQ1PO3L6NblSIQW67jl804KFKBxE3JT4GMIBt4YyOQ5BqHpb9Iep2DSPl9SHIlaPGchz27Js3cOHLQwGbKrrpJlUXMmYpRKKhjcSgPWGbJw+a16WOv8AqAxbRtSV6Jm7SVRnUAYxbNgYkiluEjoDt0iG5uTmETZ4jgRztLhgr4r7pV68anUs+oqta2Tewsmuk6eNUohi2BwumbcVUxkUSGE+cZNnJsBnOAsOJbIWOD2dVlLJQsFjg9nVZSyULBY4PZ1WUslCwxqW+XJb7Rd+/HsL2h20e5Qme/yfdNp2W0eSZTdwc56ur/1srIOzKd9J/Mj+O0onsunfSfzJTx2VHZlO+k/mR/HZDsynvSfzJTx2DsynfSfzI/jtInsunfSfzJTx2VHZlO+k/mR/HZDsynvSfzJTx2DsynfSfzI/jtInsunfSfzJTx2VHZlO+k/mR/HZDsynvSfzJTx2DsynfSfzI/jtInsunfSfzJTx2VHZlO+k/mR/HZDsynvSfzJTx2DsynfSfzI/jtInsunfSfzJTx2VHZlO+k/mR/HZDsynvSfzJTx2DsynfSfzI/jtInsunfSfzJTx2VHZlO+k/mR/HZDsynvSfzJTx2DsynfSfzI/jtInsunfSfzJTx2VHZlO+k/mR/HZDsynvSfzJTx2GCzhSEqGZIkpzCFk3gFPjG4OefjjyWG9S/xeV/rsvgcWVaWD1Ysi4gaQqqqG0q8pynpCTQg2ZpGSUatzKFaNiiG5ZQQDwCB5RHhZcVW3brO3CTVsmKiqxyppkDrMYRwAB/aNkWFT0zO0ZUMjSdTxyjCWinB2jxqcSmMiqQcGKIlEQEQH2hELityoaBrGlayW08n6fdNajbuSM1I3AHVBY+3YmAFEQEw7i4wI9YXao+i6dV6esVtPSUfLjUzcyxFYgGh+9kMkmZRTKWN3gpkMceHzQEeqysdshZXs0aOX7pFgybnXcOFCpIpJl3GOcw4KUADrERwFkX5dNdQDSVQQ5aMmBfUogs6nG4ND745JIwFUOuGPuylEQyI9VlVz6l6jjIKLqeQhHraImzrkjnqqJiouzIGKVYEzDwNsMYoGx1CNhV2FxLUjUkHBQdSysUq3jKkSXXinBjFEroiKxkVRLgchtUIYo5AOIe1ZFPYxLBZT1YshYxLBZT1YshYxLBZW2jEyrmNdTDaMdqx7FRJF06IiYyKB1d/KKc4BtKY/LU2gIgI7DYzgbI1LGJYY1LfLktn3Rd+/HtCysqX+LSuf4jP4HFhZ2Cw75dE5WhNEtG4Cc1CruBpw+rE6qMkxlW7lUZOmEElmZ0A5KZ+UJl3CigGOJCmAhOOAEQmJD0i9HnPR/iqVpqB0IgtSJqZ1BlIGo5GUhjvVmbZuugVmmgcODQVm6guAVwAhkBzgMWFtqjCEpyZrOtqN0EgNUJ+ptW5aBl+1Ic8iLJsQqQotkih8XOqKhzc4MGDgGeAYDhfpEf8AzC5H/wDNYn4W10l2bpZemdbulLUtbFUZxtf6TS9Vw0wgUoJhNQHIfNWTooB1rIGURQPw4kMmYTcALcGI6V6WaGtNMdM4SZoVpPMa3pdeRmHTShncpLOXZucCnd5NM+1oLcxSAKYF4AURNneAhRpUBo7otWFAQNfSFMQSP9K9JsqAggI2RIDSqiJPk13pUsfdnFRizHeAAIi6NkRyO5UdXulNF0/RurYUDSkawYloiIjIJ24YpFTF3IoNiC7cKCX5yormUKJuvwA48AwHdhtV9HUy9g9XJkzFdHpUOoSDlmu0oA2ZdmGbSRgH+7h64SE39Uc8OAwYbP0fGUUzmdPG1ERVe1ToHpzFgxp58yM/aKS0k+KvKPO7l/0xUk10xwYBDyiHtDBXy0DQVD01UGsEnoVRjepl9L4moXVLyEPuYMJJaX7qVwRsf/QlUTAh+UAgHAQHIGHIb1N0/TNadF+kNRmlJ09UupEZTtTyVP0auyKEeVBSdci6dotNopuBQKf7ttnAAGdpxAoBRjhKApOp+jWLGl9LKfiZuM08PUcohUdJOG0g62AKqkwxmkxEhyGAQ2Nj7SiHg4xnaGYaqaf02tXOpWljno3UrAULEUAvUTCrWcCLZ0k+TYJrkXB4XAGILgTIigXgO0eGd2YNOsdEaTi9C67papqFoxlNUfRjGWKtCUo7TXYvR5JymUm1TbXhlCHNvSIAl+cACGw2VRi2t9HMoKarDR+C6MMAGn9PRceuxrpuzFB+1RMVARk1JEcg7KcTqAKIdfUGBIbNGT9JzTTRem6B1LpKK0/asjUagwPBPYyhHbRdkYVEy5dywnMR4RcpjABjhgRMAl4hYfn1YRYLBYTYRYfoN/lVLUkhTOtqteqRBKeBvB9ojLCmDPkj38Dc7m+Bt8g7uFyVj7XWjpZOOjK41EUP0aW0slGZP38VREI8yuQwLMp/vQJ87O/Bc42ABcXUcI2GMy3y5LfaLv349oFlS/xeV/mMvgcW8RZ2Tg9nVZVhK1DPzqTBCcnJCRTimpWLAjtydUrVsUREqKQGEeWmAmMIELgAER4cbDJWet2s8evIuWGrlZt1pgqZJBRKedFO7KRMEyAqIHyfamUpA3ZwUAKHDhYeEVq9qxBPpaThdTqsYPJ84qSzhtMuUlH5xzky5inAVR8I3EwiPEfbsnClkKpqeXqA1WS1RSj6cOsRyaTcO1FHZlS42qCsYRPuDaGBzkMB7Vle7Kt60jajc1hHVfNtZ96ddRzKISCqbxc62ecY6wGA5hPuNuERHduHOc2RuQ+qOpdP006oyB1CqWOgH28HMW0lV0mi28MH3olMBB3BwHIcfLmytJrWtZMWcXHsqtmW7WDe9oxaCT9UibF3uA3PQKBsJK5KUd5cGyUOPCyK6Tk5KaknUxMyDl+/fLncunTlUyqy6xzCY6ihzCJjGMYRERERERERGyttzVFTPY6Kh3lRSa7CCFUYpqq7UMiwFQ+9TkEEdqW4+DG2gGTcRyNkb7XUnURlViles69qJGplxEysynKLlfKCIYHcuBuYOQAAHI9QYsrzk9QK8mnMu9mK1nnzioCJpS6rmRWUNIETMUxCuBMYRVApiEEANkAEpRDqCyIjK+ruFXhnMNWs8xWp0qxYdRtIrJGjiqmMZUG4lMAogcxziYCY3CYwjnI2VvL6taqOqWPQzrUqqVqdUEd8SpLuDMzZNvEBRE+wQ3eFjHXx67DKtYuktqprHKyiktVMwwgJUWwnpxvKuDRpDIoppgIImNt4ikB+r5wiNhjTvWXV5/T5aTfap1c4hCNe4FjVZtyZqDbwfueUJ9vL8AngYx4JeHALI1X2qGpUnSaFBSWoVSu6aa7ARh15Rc7JMC8SgVATbAAvkAA4eSypl9UdS6gpprRc9qHUsjT7HYDaKdyq6rRHYGCbETGEhdocAwHAOqwxeyFjg9nVZSyULBY4bCUhIIsV4tF84IzdKJrLtyqGBJU6YGAhjFzgxigooACIZDebHWNla9koWGNS3y5LfaLv349he0P2RyJntXveN7LZ3fb7TnOd39llZB+EPzj6KyJ/CH5x9FZUfg/84+ish+EPzj6KwfhD84+isJ/CH5x9FZUfg/8AOPorIfhD84+isH4Q/OPorCfwh+cfRWVH4P8Azj6KyH4Q/OPorB+EPzj6Kwn8IfnH0VlR+D/zj6KyH4Q/OPorB+EPzj6Kwn8IfnH0VlR+D/zj6KyH4Q/OPorB+EPzj6Kwn8IfnH0VlR+D/wA4+ish+EPzj6KwfhD84+isJ/CH5x9FZUfg/wDOPorIfhD84+isMFnOV+oZnkbuX2m82b8btvPPjOPLYb1L/F5X+uy+BxZVpYPViyNhdg7bNWzxZLai7AxkTbgHcBTbR4ZyHEPLYxHzB3HLA3eJctQyZFQLuAfBOUDFHgPlAQGw17K2Xse5YFbGcFKAOkAcJ4HPgCIgH9uSjZHmi1cuCLKoImORuTmKiAcCF3AXI/2iAf22MXlYbMdHuZR2Ri0KAqnKcwAI4DBSiYf9hRspHx7yUdEZMEBVVOAiBcgAAABkRERHAAAAIiI8LI9ZOGfxPKF4RMU1wEySqKxFUz4HA4MQRDIeUPXYxaNgsp6sWQsYlhssI9zJLmbtSgJypKLDkceCQgmN/sKNla3qxZCxiWCynqxZCxiWCynqxZCxiWGNS3y5LZ90Xfvx7QsrKl/i0rn+Iz+BxYWdgsMrNDyVQ0xDBCtDvDshcIuE0uJkxMpuKJg8gCA9fVwGwyTdJnLUKdOiRZ+0JFtymS2nNvIkYqnL9sQEDBw44zYeShXwLyBolNP9TBHsxVBEpRUBTI87aAcN+OXuxx+dYey7WUXnGqyixk5BvApnUTaIpqLnOKogYEwHwSnDIiIhxDBsWHo9VlEXsi0izuCPXcEiuKYCXmqLFVKBhHbwE+wDAOPXYeTQUU6fZ91YO3MWaLHvQEFErbnbTbxUMbiCgG4hxzwLi4j0hwmQdMQjkyfp3soRAwFLs5vdx35H+LzM58uM+S6MPoMu6cOYA5ihWq4ptsgAOjCQQ5I58hgEfXw4ccWVt1kkckJEd5i+yFiHXKEfx4EyUebg3hhuHh4QjnaGLCzgU3rulEmpUl2TcEHJjOilTVaLfOEeeA8SH/ugIjn5ogFkbqoop0+UGrB24iBiA3CUUStiq8vwjCI8eaCmRxndkMBwsqvfhPBFECHRbmp4YognMoUnJ38sOYJh/jczdjy5xjhYbbgrzkuimTT/AEqETlA20vL5vJDaID/F5vX5evyWHm+knTh9JQKxiixLAkVBHYABzCtSHKfqzuz5fa4WRvtwmQWcFZpk/TnYqotjAUuzd3UciUevmbt27y43Z4WFYCT51RuwyS7BujHCcDbE1WTjA5znrIsI8PKOQ8llVVBtXihZF2wXcgqgRMvKZokO5OBjDxIJvmlDAbhD2wsMklknqD2YLSxU05Y6rNRXaKYKCiZuAnEvkwJxybb7YeSwiULJA+lhgCJDNghHbe7FKJuTyfvBSAPJu2Z2+TFkYdWpUwmgDCQOe7IC8BIA2g52BzOrhnPXjy5sqhsJsIsFgsJsMZlvlyW+0Xfvx7QLKl/i8r/MZfA4t4izsnB7OqypKYxfmiIZ4cOFko2UJF0gxcRyRgBF0dNRQMcdxN23A+T5w2GtkQscAZAQEM8LAHCxQyOMZ4WDI4x5LHCPZ1WVImMYcmEREfKNkoZHGM8BsGRxjyWODj1ccWU8mLIiwnI4wPVY4OOMccWUDIdVkb8XMKRhFUu4snaSwlEyblHeAGDOBAeAh1j1Dx8ubDxk5J3LPlJB6coqqYztKBSgAAAAAAHUAAAAH/Kxw1fZ1WUslCwWOD2dVlLJQsMalvlyW+0Xfvx7Cypf4vK/zGfwOLKs7Imyv0K6P9CVBUGkGgLKiofSBYk6pOHqJnVcawXfSrdGUW3coiiZnCwEQKcPux8HBciAAAgIcCamaN6TyM9RlT6cPZJKntRdQpuEbJFMAJN41B61TQM3A5N5REjgw/eCYcAQBABA2YMgP0d+jpRrCek9Takr8UmuqUxp7HEhhZibkNeXy3Swqp4yXeO8C/OyUCgXAiNGKaX6YuqD6bsTpO1qNdFSGrE8UjKItkDq8shzFKqCa5FEt4lwODFMACPlwA3CjMqL6O2gFSMNMmlb1ZXLar9XVZJFmpHJMxj2LhKQWbJqKkMQDmIcSEDYQQEBAw5ABAoB12o+tKj0iqt89iGcG5fokVjlSykS2kUAAFC7hKm4IYoGymGDgAGwIhnAjmo7sajabl1x1/rrSZxCxUTRFBQ8bUpmlMQcUwlHa6ke2EG6btQhAKB1XSpxFQwkDaAbc7cRXHsn0Q9H6YrWaWqqpqvb0gw0+UrXurZwwXl2i6TxFBRiqdPe3UMIKCJTl2Bk5RHAFNkNfT/o59GWsIzTxaQqHUlg81blZqNp0iZmKpGBWrkUkFHg8soqZAyQGKnjI7xASgABYZDo/ohpUeu9PdQNDazrNgQaul6PkFZxnHuFu8oxii4OW6ZkjpAmcgiGxUpzF3cBASgYQxehejNoJU7bTGjpWqq3a15qnTqspHqIFami2Lgp3BUwWASc0xFBQEuCjkohkTCBsFqPrSPoe0jqVpM2qRw11CZTUlDSEk2mFk2LaFIu3IocqJUVDd6clMCeBVSwUBHqwAiBXHXSiaNGjTRkWrVFEV9KoVZXlkAvMOK7vJjY6xEADiPHgFhwbZCwmyo4WQsFhNlRwshYfoR0fqMhNb+isai5fSKtm8ZGxxQTdxNOMVk5J+SVKYz1k6VOmudwKZzIqkE/KBNI4FEBLsGSsavHpR0vT1V9ILS7Q+Y03mYSHXrI7BKYeQzaMQcRSizdIGEedsGFkSFATAoqIqgZcMgUDYFUox+iNaX2qPSZX6NtT6dUwGmMtKv6Zb002gWqCkUkmChEnCLgqYLFXTFIpzHEwhnfgC+DtYEOk0mzLHyTtgRcq5Wy6iJVS9SgFMIbg9Q4uoxGW+XZb7Rd+/HsLGl/i8r/AF2XwOLKtLB6sWRySw1+r2JZ6ZtYgWDFTSld04g3KKRwVUM4di6UBxk4lOXeIlwBSgJBEo5yI2VnkH00qyhV3Cymlmm0kUtSL1ZEovYlwonCyKwlFQzQAcAJCCcoHAhhMAGwIYAAAAwWstfqyrePdRstHQySbytZCuzi3QVKYJB4BAVTDcoIckOWG0uNwZHJx8kEJ691inryPSHLGw/6jGZNOd15KvcueIiO3ZzOZs9XMz67D2jukNWsZKabSyEbCmW0uXWcQ5ToK7VzKPTuzd4AFA3BzFDAGzZ4OA6/CEVccST9aUkXUm4KQqrxc66gEAQKBjGEw46+GRuo5dDpU6gH1WqDVd5A0w9WquKShJuEcsVFYt8zTboogmdMygqAOG6R9xVAMBwEQEAHbcVqS/SQqV+6nzRVEUXAMZ+lhpA0dERh27dsxFdNcTp4UE51xOkGVFTKCICIY6sVGpTfSGrWliaZpx8ZCnDSl+8kIbnIKjz1HK5VlAcYUDcUDEAA2bBwI5ER42Vv6c9J+v8ATBnFsoGJgHBImqHdWoi8brHEzxwyFmchtipQFIExyABg27iJhDhZGrAdI+uKdq/Tms2UXBqPdMY0sVEJqoLCkukCi6m5wAKAYxsuDhkgkDAF4dYjFZZTHTQr6mIOEjSUDQUlKU/T6lLMZ5/GLHkU4sxVCggByrlKG0FTYMUgG8giYDGAxGGyWv0/NR7eOm6Mo+RKyolGhmSruNOso0apKmUI7REyg8t2AnMHNKABgeBfLdVrVPrOapo6o44dLNPIoKjJGEFaMg+QrHdyLtyzNvHkit1rde/1WHHNg9WLIWMSwWU9WLIWMSw5eX6TVcLaQIaQ9iwCaSLBKHCbI2UCSGOTed8I138zlgQF8GEQTAwgUoCI44xXrqt0pNQNVhhFXEXB065hpZaoe8QaCqCjqWVBIDvVBOofap9wQcJgQu7cOMjwYDJHvTXrlVeRqSL0309hq5l2h2j2so6HOlKn3lAqqxB5opJLqBuA6hEwEd4429dirrxdRjUt8uS2fdF378e0LKypf4tK5/iM/gcWFnYLDsXRvR10hkaD0yqCvNXZ2npbVFV6hHJNqcK+atToPjNA5pwcEPgxgIPglHG4fayMGNVJ0RtcqeQquXLSyL6CpGRkI17LJSDdNBRRmbCopkUUKoYRDBikAm8wCIAURAQAPiQ6IXSIhuxjTmnDiOTnHiDBBRy9bFBBdYMpkchzMtREOIc4CeQOsQC6Mz1b6GNXw2rz3SvRyEmajCEikHknIyL2PQQE51VE+ZvKty25DCTBEljgsIlMIlxiwwCneitr9VM9UdMxGnLrtKkV0W82g7dtmncTLFOZITmWUIXYYqZhA4CJRDaOfCLkNc3Rm10Lp+pqiOnb39NptBkDOQXQFXugCIC5Bvv5woeXmgTZjwt2ONkbdQdFLpA0tR7ivZzTly3g2jRF+s4K9aqmI1VIBiL8oigqcvBgyfbtKICAiAgIAqrVedGPXhjp5/So804fpU13MkkLkVUecVof5rgzbfzwREOPMEm3HHOONh51B0atcqWoEmps/p4/aU4ZFFwd0ZVEyiKKwgCSiqBTiskQ4iAAY5CgOQ42HzWXRw1r0/pBOvKwoJ1HQpwQFRYzhBRRtzwyj3hEhxVb7wxjmkJkRAOsbI41spYLCbCLBYLCbCLBYLCbCLDmzo+dFSuekpTlayWnsiw7WpDuBixjseV38rkHGQIsI7SHL3cAADgBTb+Ji7eLAo4sq6jaqoGfdUtWtPP4SWZm2rs3qBklC+0OB6yiHEDBkBDAgIhYU9hjMt8uS32i79+PYWVL/FpX+Yy+BxYWdk4PZ1WV2fbdK1fTnQzSCl9MTU04qqmUZo0i5kacSdu4lZaRUWbi3XcJiUomTOBh5YmDOANxDFhj0jrrHOdOdLFJOacTtSU/XcvVdQs3BVMuBVWaKpqKHMAEOZQU1+oREMmzjIZg5j1v6RWk8xTtaLUTX1LOE6+mo1+rGR9CuGUlyknhXRjSDw5gIc6QgYoCnzBOIiOCgYRCo+IbpFaMydZa7Qb+fptvGV1UzedgpeoqXcyka5TSUUymu3KUFkzCVQDJmEnAd+cZDMVh2smv9F1jSusUKxrZKTd1E8pNtFLNoJWMSkmsem4KscEcnBIhBMkBSqGAwgBBAuQEADkCS6UGk8jQbeqYirqTh55LT4lLLwytCrOZlRyVt3czcj7cCANT/OAwmyUvDYI8LDApTXnTt1q/X1SJ1cqaGmtHlaSYKi0c7VZAYZBEG2zZuKHeSGDcYAJkN27GDXR8atVxofqI8nNbmGuE/Dzs1SLaJCio6LcorFeJtEWxmqjj/QGYG5W84AbJgMIbd3C4M/1u6T+lFZU9XVZ0hWFLNJKu6fRilIJKhlgnAMdNIiqDqQMYqBk0xTAxTlEw+CQALkvEMV151Y0PrfSGe75X0TWtcviRKcLKsaYdw0wcqQk54TJsg1cbEy8sm3eO4CiA4wJaOntk4PZ1WUslCwWOD2dVlLJQsFjg9nVZSyULBY4drehF0rqN6LNOakyE/Dv5mYnuySxEc2wmVYyIPOYZVYQEEiF5qfEAMYdwYKOBEJK4OKekJ0ldSuknUqM/Xrhmk3YAdONjmSAJoM0zCAiUBHJziOAETHMI56sBgAEuKLqMblvlyW+0Xfvx7DYgH7Vks6bPVQRTeFSEqps7SnTE+AMPkAQUNx9VpVd8+P8AdqI/ckA//u4HPj/dqI/cm/17oc+P92oj9yb/AF7hRHPj/dqI/cm/17CefH+7UR+5N/r3TU58f7tRH7m3+vYoc+P92oj9yb/XuFEc+P8AdqI/cm/17CefH+7UR+5N/r3TU58f7tRH7m3+vYoc+P8AdqI/cm/17hRHPj/dqI/cm/17CefH+7UR+5N/r3TU58f7tRH7m3+vYoc+P92oj9yb/XuFEc+P92oj9yb/AF7CefH+7UR+5N/r3TU58f7tRH7m3+vYoc+P92oj9yb/AF7hRHPj/dqI/cm/17CefH+7UR+5N/r3TU58f7tRH7m3+vYoc+P92oj9yb/XuFEc+P8AdqI/cm/17CefH+7UR+5N/r3TU58f7tRH7m3+vYoc+P8AdqI/cm/17ggXsQh964mY8xC8RKg6TWOb1AUgiIjdGLKrneOXD05NhnS6rgS/6onOJsf7bI+TAHG6PIwBm4IwHtXQwFgwFgwHtWDAXAwF0MBYMB7VgwFwMBdDAWDAe1YMBcDAXQwFgwHtWDAXAwF0MBYMB7VgwFwMBdDAWDAe1YMB7VgwFwfYAGbo9C2H/9k=</xbar.image>
// <xbar.desc>Show notifications for Slack teams and channels with option to mark as read. See https://github.com/benjifs/bitbar-slack-team-notifications for configuration instructions.</xbar.desc>
// <xbar.dependencies>node.js superagent</xbar.dependencies>

const request = require('superagent');
const tokens = require('./.tokens.js');

// CONFIG
// XBAR_SLACK_ICON defines which Slack Icon is shown
// 0 -> Original Slack Icon
// 1 -> White Slack Icon
// 2 -> Black Slack Icon
const XBAR_SLACK_ICON = process.env.BitBarDarkMode || process.env.XBARDarkMode ? 1 : 2;
// If MENTIONS_ONLY is true, the count only includes mentions and DMs.
// If MENTIONS_ONLY is false, the count includes all unread messages.
const MENTIONS_ONLY = false;
// MAX_LENGTH of channel name or user name
const MAX_LENGTH = 18;
// Show `No new notifications` message
const SHOW_ZERO_NOTIFICATIONS = true;

// Is Slack.app installed?
let SLACK_INSTALLED = true;
const { exec } = require('child_process');
exec('ls /Applications | grep Slack | wc -l', (err, stdout, stderr) => {
	if (!err && stdout == 0) {
		SLACK_INSTALLED = false;
	}
});

const DEBUG = process.argv.indexOf('--debug') > 0;
const SCRIPT = process.argv[1];

// Slack App Credentials
const SLACK_OAUTH_AUTHORIZE = 'https://slack.com/oauth/authorize?scope=client&client_id=';
const SLACK_CLIENT_ID = '11708641376.684689498789';

// Slack API
const SLACK_API = 'https://slack.com/api/';
const SLACK_CONVERSATIONS = 'conversations';
const SLACK_CHANNELS = 'channels';
const SLACK_GROUPS = 'groups';
const SLACK_IM = 'im';
const SLACK_TEAM = 'team';
const SLACK_USERS = 'users';
const SLACK_INFO = '.info';
const SLACK_LIST = '.list';
const SLACK_MARK = '.mark';
const SLACK_HISTORY = '.history';
const SLACK_AUTH_TEST = 'auth.test';

// ICONS {
// Original Slack icon (unused)
const SLACK_ICON = 'image=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';

// Dark Slack Icon
const SLACK_ICON_B = 'image=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';

// White Slack Icon
const SLACK_ICON_W = 'image=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'
// }

let unread_count = 0;
const slack_output = {};
const errors = [];
let call_log = {};

debug('Debugging');

if (process.argv.indexOf('--mark') > 0) {
	console.log('Mark as read');

	let token;
	for (let i = 3; i < process.argv.length; i++) {
		if (process.argv[i].indexOf('--token=') === 0) {
			token = process.argv[i].split('=')[1];
		}
	}
	if (!token) {
		console.log('Error: Missing token');
		return;
	}

	for (let i = 3; i < process.argv.length; i++) {
		let args = process.argv[i].split('=');
		if (args.length != 2) {
			continue;
		}
		if ([SLACK_CHANNELS, SLACK_GROUPS, SLACK_IM].indexOf(args[0]) < 0) {
			continue;
		}

		let channels = args[1].split(',');
		for (let j in channels) {
			console.log('/' + args[0] + SLACK_MARK + ' (' + channels[j] + ')');
			slack_request(SLACK_CONVERSATIONS + SLACK_MARK, token, {
				'channel': channels[j],
				'ts': Math.floor(Date.now() / 1000) + '.000000'
			})
				.then((body) => {
					// console.log('  Success: ' + args[0] + ':' + channels[j]);
				});
		}
	}
	return;
}

function debug(message) {
	return DEBUG && console.log(message);
}

function slack_request(URL, token, query) {
	debug('  /' + URL + (query && query.channel ? ' (' + query.channel + ')' : ''));
	// The following is to keep track of how many calls are being made
	// for each token to each method. Should help debug the rate limits
	if (!call_log[token]) {
		call_log[token] = {};
	}
	if (!call_log[token][URL]) {
		call_log[token][URL] = 0;
	}
	call_log[token][URL]++;
	return request
		.get(SLACK_API + URL)
		.query(query)
		.auth(token, { type: 'bearer' })
		.then((res) => {
			debug(res.body);
			if (res && res.body && res.body.ok === true) {
				return Promise.resolve(res.body);
			}
			return Promise.reject(res.body.error);
		})
		.catch((err) => {
			debug('ERROR: ' + err);
			debug('  ' + URL);
			debug('  ' + JSON.stringify(query));
			errors.push(URL + ': ' + err + ' | color=red');
		});
}

function output() {
	unread_count = unread_count > 10 ? '10+' : unread_count > 0 ? unread_count : '';
	const slack_icon = XBAR_SLACK_ICON == 2 ? SLACK_ICON_B : XBAR_SLACK_ICON == 1 ? SLACK_ICON_W : SLACK_ICON;
	if (errors.length > 0) {
		console.log('! |color=red ' + slack_icon);
	} else {
		console.log(unread_count + ' | ' + slack_icon);
	}

	if (Object.keys(slack_output).length) {
		for (let i in slack_output) {
			let team = slack_output[i];

			if (SHOW_ZERO_NOTIFICATIONS || team.notifications.count > 0) {
				console.log('---');
				console.log(team.name + ' | size=12');
			}
			if (team.notifications.count > 0) {
				if (team.notifications.channels.length > 0) {
					console.log('Channels | size=12');
					for (let j in team.notifications.channels) {
						console.log(team.notifications.channels[j]);
					}
				}
				if (team.notifications.dms.length > 0) {
					console.log('Direct messages | size=12');
					for (let j in team.notifications.dms) {
						console.log(team.notifications.dms[j]);
					}
				}
				console.log('Mark all as read ' +
					'|shell="${SCRIPT}"' +
					' param1=--mark' +
					' param2=--token=' + team.token +
					(team.params[SLACK_IM] ? ' param3=' + SLACK_IM + '=' + team.params[SLACK_IM].join() : '') +
					(team.params[SLACK_GROUPS] ? ' param4=' + SLACK_GROUPS + '=' + team.params[SLACK_GROUPS].join() : '') +
					(team.params[SLACK_CHANNELS] ? ' param5=' + SLACK_CHANNELS + '=' + team.params[SLACK_CHANNELS].join() : '') +
					' refresh=true' +
					' terminal=false');
			} else if (SHOW_ZERO_NOTIFICATIONS) {
				console.log('No new notifications');
			}
		}
	}
	if (errors.length > 0) {
		console.log('---');
		console.log('Errors');
		for (let i in errors) {
			console.log('--' + errors[i]);
		}
	}
	console.log('---');
	console.log('Add New Workspace');
	console.log('--Generate OAuth Token | href=' + SLACK_OAUTH_AUTHORIZE + SLACK_CLIENT_ID);
	debug(call_log);
}

function format_channel_name(channel) {
	let name = '';
	if (channel.is_im) {
		name = '@' + channel.name;
	} else if (channel.name.indexOf('mpdm-') === 0) {
		let users = channel.name.split('-');
		users = users.filter((user, i) => {
			// mpdm string is of this format: `mpdm-xxxxx--yyyyy--zzzzz-n`
			// where xxxxx, yyyyy, and zzzzz are usernames
			// Remove empty strings, first, and last elements of the array
			return user !== '' && i !== 0 && i !== users.length - 1;
		});
		// Using │ since xbar can not display the standard | character
		name = '@' + users.join('│@');
	} else {
		name = '#' + channel.name;
	}
	if (name.length > MAX_LENGTH) {
		name = name.substring(0, MAX_LENGTH - 1) + '…';
	}
	return name;
}

function channel_output(channel) {
	unread_count += channel.count;

	let output_str = format_channel_name(channel);
	output_str += ' '.repeat(MAX_LENGTH + 2 - output_str.length);
	output_str += (channel.count > 10 ? '10+' : channel.count);

	let key = channel.is_im ? SLACK_IM : channel.is_channel ? SLACK_CHANNELS : SLACK_GROUPS;
	let href;
	if (SLACK_INSTALLED) {
		href = 'slack://channel?team=' + channel.team + '&id=' + channel.id;
	} else {
		href = 'https://app.slack.com/client/' + channel.team + '/' + channel.id;
	}

	output_str += '|font=Menlo size=13 href=' + href;
	let alt_str = 'Mark as read ' +
		'|alternate=true' +
		' font=Menlo size=13' +
		' shell="${SCRIPT}"' +
		' param1=--mark' +
		' param2=--token=' + channel.token +
		' param3=' + key + '=' + channel.id +
		' refresh=true' +
		' terminal=false';

	if (output_str[0] == '@') {
		slack_output[channel.token].notifications.dms.push(output_str);
		slack_output[channel.token].notifications.dms.push(alt_str);
	} else {
		slack_output[channel.token].notifications.channels.push(output_str);
		slack_output[channel.token].notifications.channels.push(alt_str);
	}
	slack_output[channel.token].notifications.count++;

	if (!slack_output[channel.token].params[key]) {
		slack_output[channel.token].params[key] = [];
	}
	slack_output[channel.token].params[key].push(channel.id);
}

async function run() {
	if (typeof tokens === 'undefined' || !tokens || !tokens.length) {
		errors.push('Missing Slack Legacy Token | color=red href=https://api.slack.com/custom-integrations/legacy-tokens');
		errors.push('Generate OAuth Token | color=red href=' + SLACK_OAUTH_AUTHORIZE + SLACK_CLIENT_ID);
		return output();
	}

	for (let i in tokens) {
		await get_team_notifications(tokens[i]);
	}
	output();
}

function get_team_notifications(token) {
	return get_team_info(token)
		.then((team) => {
			if (team) {
				slack_output[token] = {
					'id': team.id,
					'name': team.name,
					'token': token,
					'notifications': {
						'channels': [],
						'groups': [],
						'dms': [],
						'count': 0
					},
					'params': {},
					'errors': []
				};
				return get_auth_info(token);
			} else {
				throw 'Invalid token';
			}
		})
		.then((user_id) => {
			slack_output[token].user_id = user_id;
			return get_team_conversations(token);
		})
		.then((channels) => {
			return check_channels_unread(channels, token);
		})
		.then((channels) => {
			for (let i in channels) {
				if (channels[i]) {
					channel_output(channels[i]);
				}
			}
		})
		.catch((errors) => {
			debug(errors);
		})
}

function get_team_info(token) {
	debug('Fetching team info for ' + token);
	return slack_request(SLACK_TEAM + SLACK_INFO, token)
		.then((body) => {
			if (body && body.team) {
				return Promise.resolve(body.team);
			}
		});
}

function get_auth_info(token) {
	debug('Fetch auth info for ' + token);
	return slack_request(SLACK_AUTH_TEST, token)
		.then((body) => {
			if (body && body.user_id) {
				return Promise.resolve(body.user_id);
			}
		});
}

function get_team_conversations(token) {
	debug('Fetching conversations for ' + token);
	return slack_request(SLACK_CONVERSATIONS + SLACK_LIST, token, {
		'exclude_archived': true,
		'limit': 200,
		'types': 'public_channel,private_channel,mpim,im'
	})
		.then((body) => {
			if (body && body.channels) {
				return Promise.resolve(body.channels);
			}
		});
}

async function check_channels_unread(channels, token) {
	let req = [];
	for (let i in channels) {
		if (channels[i]) {
			req.push(is_channel_unread(channels[i], token));
		}
	}
	return await Promise.all(req);
}

function is_channel_unread(channel, token) {
	return get_unread_count(channel, token)
		.then((unread_count) => {
			if (channel && unread_count > 0) {
				if (channel.is_im) {
					return get_user(channel.user, token)
						.then((user) => {
							if (user) {
								return Promise.resolve({
									'id': channel.id,
									'name': user.name,
									'count': unread_count,
									'team': user.team_id,
									'is_im': true,
									'token': token
								});
							}
						});
				} else if (channel.is_member || channel.is_group) {
					let team = channel.shared_team_ids && channel.shared_team_ids.length > 0 ? channel.shared_team_ids[0] : '';
					return Promise.resolve({
						'id': channel.id,
						'name': channel.name,
						'count': unread_count,
						'team': team,
						'is_channel': channel.is_member && channel.is_channel,
						'is_group': channel.is_group || (channel.is_channel && channel.is_private),
						'token': token
					});
				}
			}
		});
}

function get_unread_count(channel, token) {
	// unread_count_display is a count of messages that the calling user has
	// yet to read that matter to them (this means it excludes things like
	// join/leave messages)
	// unread_count_display does not show up consistently.
	// In the case unread_count_display is not present, check conversations.history
	if (channel && !('unread_count_display' in channel)) {
		return check_conversation_history(channel, token)
			.then((unread_count) => {
				return Promise.resolve(unread_count);
			})
	} else {
		return Promise.resolve(channel.unread_count_display);
	}
}

function check_conversation_history(channel, token) {
	debug('Fetch history for ' + channel.id);
	return slack_request(SLACK_CONVERSATIONS + SLACK_HISTORY, token, {
		'channel': channel.id,
		'oldest': channel.last_read != '0000000000.000000' ? channel.last_read : 0,
		'unreads': true
	})
		.then((body) => {
			if (body && body.unread_count_display > 0) {
				const user_id = slack_output[token].user_id;
				if (channel.is_im || channel.is_mpim) {
					return Promise.resolve(body.unread_count_display);
				}
				return Promise.resolve(count_mentions(body, user_id));
			}
			return Promise.resolve(0);
		});
}

function count_mentions(body, user_id) {
	if (MENTIONS_ONLY && body.messages && body.messages.length > 0) {
		let count = 0;
		for (let i in body.messages) {
			if (i >= body.unread_count_display) {
				break;
			}
			if (body.messages[i].text.indexOf(user_id) >= 0) {
				count++;
			}
		}
		return count;
	}
	return body.unread_count_display;
}

function get_user(user, token) {
	debug('Fetch user info for ' + user);
	return slack_request(SLACK_USERS + SLACK_INFO, token, {
		'user': user
	})
		.then((body) => {
			if (body && body.user) {
				return Promise.resolve(body.user);
			}
		});
}

run();

