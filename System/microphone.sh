#!/usr/bin/env bash

# <xbar.title>Mute Mic</xbar.title>
# <xbar.version>v1.0</xbar.version>
# <xbar.author>Vasily Pleshakov</xbar.author>
# <xbar.author.github>wasapl</xbar.author.github>
# <xbar.desc>Mutes or unmutes microphone.</xbar.desc>
# <xbar.image>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</xbar.image>
# <xbar.dependencies>BASH</xbar.dependencies>

SCRIPT_NAME=$(basename "$0")
SCRIPT_DIR=$(dirname "$0")
TEMP_FILE="$TMPDIR/${SCRIPT_NAME%%.*}.tmp"
MENU_LINE="| bash='${SCRIPT_DIR}/${SCRIPT_NAME}' param1=switch terminal=false refresh=true"

# icons Made by Dave Gandy
# https://www.flaticon.com/authors/dave-gandy
ICON_MIC="iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAAAAABWESUoAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB2UlEQVQ4jY2Sv04UURTGf/fOTqZwC0BjNhSSlURMNiEhhlhQaMIDYGcCHbwAT0ChHW8guhotTKzstKazJDREN/ivUJYAWVeEzM7c+1nM7M66g9FTTeb8zjnf+e6BQViqG604bm1UsVwQlvqunOS0W7+IMIzvKXGSS7Q3jikBAZuKJUmKtUlQbhB9lMsAp/2o1MIy3ZPPAK/e9EBFoSYK+1WGMBqq/EcUQFn3/3WoABAYjSZMRa4AXLlTls5GGNafVEfqqTbXi61qHa0wq6GYZUWdGgYsGEJDxEhEmDAH/rbLUMp5KqSOfBXhEip4lwOi22WSb+2i+OA7k/zoogwwp5+Yp/OGNEunvO0wz+fTvjsVHurnDNcP1fOS76ld5+apHuQmgaVxrqewcCwveR0vwDOdNwrtAVvSGkw12963m1OwJj0auirDlZaSVSxjjcYYltVErcvD72uZO5Fe1DFgqD+XTubyATkVuLnXU/zafndA7fbdS3y5txO4P2wLmNiKs6P0ih9PDASYYoq/sXxn5iqH77dffrD4kvVhhGVRWsQShYPflcFXAoYzOMMQUwbM/WuJjWdg+Vbkw6+vRm4wYElpcS+plvoqczfF/pFJ0tSBS9PEHO333/43jAztfMWb5IQAAAAASUVORK5CYII="
ICON_MIC_SLASH="iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAAAAABWESUoAAAACXBIWXMAABYlAAAWJQFJUiTwAAACJElEQVQ4jW2Sz0tUURTHv+e8OzOUYVmLpEUxGCU2EhFBIirhsoVSbspwUctauC6KaBn9AxESBREyLdq1FFxbWEQRQmWQJpKNOda8H/d+W7z3Zu5IZ3k/33vu/Z7zBZql2HNnKQw/3eqA4j+lKL+jJS0Xy6lC2rig6yNjS9qYHzohEJU2RYD7DEmSbPABApHiLr+HoPSZliTpLKdgRF6+2espFD0RXcYnYVSr5EJXS6HoI5u8KFplw/3tbfnJBSlXrbLBrSHPbyZo48MIsEOwg5uWRxOgj7Qer59DoX2OfXRJzkNuDXvvC6ZnOlGhbfH6YPBkOvco6K5xEv0u55HlRUyx1g0BFBAUBCWIXHlWTDA7ERcUSzCQQiYAoCB0KudIj1NkAMI6KN4vmoxTbAgDZ5HLNn/hKGBcfh8/VnEIm79BQAHq9lcsAE2e4FUNZ/ClLsyjcPNGur/Qki7iWhm9dd7zJmkkkIzT8ecg8Jh/TvijMqpVRtxYplubOQJcIx+2rSqdX22o2F/ZB8XVmEsH/DiJVhmGvI4AEJSfkhunsgcEgFJmJyKj2Ho9/x0Hz450YHl8MbDND4hW2eDqzHYWSoaP9nsfEKT5GEHP7bmVJFmZu3sM6u+68CLNz25RjJKjUJS8rChOMsryEWCAHPDtAcbp20vP6+fnixcOxxoeBy6fLrnCt1n6PcZHgDEmbFbCMb9PADGorNsojhMyiePIrlfyOf8DeVZaaM73AA8AAAAASUVORK5CYII="

CUR_INPUT_VOLUME=$(osascript -e "input volume of (get volume settings)")
if [ "${CUR_INPUT_VOLUME}" -eq 0 ]; then
    CUR_ICON=${ICON_MIC_SLASH}
else
    CUR_ICON=${ICON_MIC}
fi

function switch() {
    if [ "${CUR_INPUT_VOLUME}" -eq 0 ]; then
        if [ -s "${TEMP_FILE}" ]; then
            SET_VOLUME=$(cat "${TEMP_FILE}")
        else
            SET_VOLUME=100
        fi
        CUR_ICON=${ICON_MIC}
    else
        SET_VOLUME=0
        CUR_ICON=${ICON_MIC_SLASH}
        echo "${CUR_INPUT_VOLUME}" > "${TEMP_FILE}"
    fi
    osascript -e "set volume input volume $SET_VOLUME"
}

function menu() {
    echo "$MENU_LINE image=${CUR_ICON}"
}

if [[ "$#" -ge 1 ]];then
    if [[ "$1" == 'switch' ]] ; then
        switch
    fi
fi

menu
